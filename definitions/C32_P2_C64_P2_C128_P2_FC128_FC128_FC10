DATA TOP data
DATA TOP labels

CONV TOP conv0 IN data K_SIZE 3 CHANNELS 32 PAD 1
BNORM TOP conv0 
RELU TOP conv0

POOL TOP pool0 IN conv0 K_SIZE 3 STRIDE 2

CONV TOP conv1 IN pool0 K_SIZE 3 CHANNELS 64 PAD 1
BNORM TOP conv1
RELU TOP conv1

POOL TOP pool1 IN conv1 K_SIZE 3 STRIDE 2

CONV TOP conv2 IN pool1 K_SIZE 3 CHANNELS 128 PAD 1
BNORM TOP conv2 
RELU TOP conv2

POOL TOP pool2 IN conv2 K_SIZE 3 STRIDE 2

RESHAPE TOP reshape IN pool2 DIM1 0 DIM2 -1 DIM3 1 DIM4 1

CONV TOP conv3 IN reshape K_SIZE 1 CHANNELS 128
BNORM TOP conv3 
RELU TOP conv3

CONV TOP conv4 IN conv3 K_SIZE 1 CHANNELS 128
BNORM TOP conv4
RELU TOP conv4

CONV TOP conv5 IN conv4 K_SIZE 1 CHANNELS 10

ACC TOP acc IN1 conv5 IN2 labels
SOFTMAXLOSS TOP loss IN1 conv5 IN2 labels


